---
- name: install and run docker
  hosts: all
  become: true
  tasks:

    - name: Add Docker repo
      get_url:
        url: https://download.docker.com/linux/centos/docker-ce.repo
        dest: /etc/yum.repos.d/docer-ce.repo

    - yum:
        name: ['docker-ce', 'docker-ce-cli', 'containerd.io']
        enablerepo: docker-ce-nightly
        state: latest

    - service:
        name: docker
        state: started

    - pip:
        extra_args: '--trusted-host pypi.org --trusted-host files.pythonhosted.org'
        name:
          - docker
          - docker-compose
