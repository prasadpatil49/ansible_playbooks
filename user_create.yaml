---
- name: Linux user creation
  hosts: all
  become: true
  tasks:
    - name: Create hash value
      ansible.builtin.shell:
        cmd: openssl passwd -6 -salt ansible {{ password }}
      register: output

    - name: Print hash
      ansible.builtin.debug:
        msg: "{{ output.stdout }}"

    - name: Creating user
      ansible.builtin.user:
        name: "{{ uname }}"
        comment: user created by ansible
        expires: -1
        password: "{{ output.stdout }}"
